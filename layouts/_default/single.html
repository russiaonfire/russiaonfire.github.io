{{ define "main" }}

{{ $page := . }}
{{ if .Params.Lat }}
<script id="location" type="application/json">
    {
        "lat": {{ .Params.lat }},
        "lng": {{ .Params.lng }}
    }
</script>
{{ end }}

<div class="post">
    {{ with .Params.Hero }}
        {{ $image := resources.Get . | fingerprint }}
        <div class="post-hero">
            <img 
                width="{{ $image.Width }}"
                height="{{ $image.Height }}"
                height="auto"
                style="width:100%;height:auto;"
                alt="{{ $page.Title | plainify }}"
                src="{{ $.Site.Params.cdnURL }}{{ $image.RelPermalink }}"
            >
        </div>    
    {{ end }}

    <h1 class="post-title">
        {{ .Title | markdownify }}
    </h1>

    <p class="text-muted">
        {{ .Date | time.Format ":date_long" }}
    </p>

    <div class="post-content">
        {{- with .Content -}}
        <div>
          {{ . | replaceRE "(<h[1-9] id=\"([^\"]+)\".+)(</h[1-9]+>)" `${1}<a href="#${2}" class="hanchor" ariaLabel="Anchor"></a> ${3}` | safeHTML }}
        </div>
        {{- end -}}
    </div>
</div>
{{ end }}
